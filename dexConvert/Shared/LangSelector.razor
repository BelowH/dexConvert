@using dexConvert.Services
@using MudBlazor
@using System.Globalization
@inject IPreferenceService PreferenceService

<MudContainer MaxWidth="MaxWidth.Small"  Class="d-flex object-right-top">
    <MudSelect T="string" Lable="Language" Variant="Variant.Outlined" Label="Language" ValueChanged="SetLanguage">
        @foreach (KeyValuePair<string, string> culture in _availableLangs)
        {
            <MudSelectItem Value="@culture.Key">
                <MudImage Src=@("https://flagcdn.com/w20/" + culture.Key + ".png") Height="14" Class="mr-1 rounded-lg"></MudImage>
                @culture.Value
            </MudSelectItem>
        }
    </MudSelect>
</MudContainer>


@code {
    
    private Dictionary<string, string> _availableLangs = new Dictionary<string, string>();

    private string _defaultLang = "gb";
    
    protected override void OnInitialized()
    {
        _availableLangs = PreferenceService.GetAvailableLanguages();
    }
    
    private void SetLanguage(string lang)
    {
        PreferenceService.SetCulturePreference(lang);
    }
    
}